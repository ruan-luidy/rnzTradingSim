<hc:Window
  x:Class="rnzTradingSim.MainWindow"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:hc="https://handyorg.github.io/handycontrol"
  xmlns:local="clr-namespace:rnzTradingSim"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  Title="RugPlay - Trading &amp; Gambling Simulator"
  Width="1200"
  Height="800"
  Background="{DynamicResource SecondaryRegionBrush}"
  WindowState="Maximized"
  mc:Ignorable="d">

  <hc:Window.Resources>
    <Style x:Key="GambleCardStyle" TargetType="hc:Card">
      <Setter Property="Background" Value="{DynamicResource RegionBrush}" />
      <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}" />
      <Setter Property="BorderThickness" Value="1" />
      <Setter Property="Margin" Value="10" />
      <Setter Property="Padding" Value="20" />
      <Setter Property="Effect">
        <Setter.Value>
          <DropShadowEffect
            BlurRadius="10"
            Opacity="0.3"
            ShadowDepth="2" />
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="StatCardStyle" TargetType="hc:Card">
      <Setter Property="Background" Value="{DynamicResource DarkPrimaryBrush}" />
      <Setter Property="BorderBrush" Value="{DynamicResource PrimaryBrush}" />
      <Setter Property="BorderThickness" Value="1" />
      <Setter Property="Margin" Value="5" />
      <Setter Property="Padding" Value="15" />
    </Style>
  </hc:Window.Resources>

  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>

    <!--  Header  -->
    <hc:Card
      Grid.Row="0"
      Margin="0"
      Background="{DynamicResource PrimaryBrush}">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto" />
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <!--  Logo/Title  -->
        <StackPanel
          Grid.Column="0"
          VerticalAlignment="Center"
          Orientation="Horizontal">
          <hc:SimplePanel
            Width="40"
            Height="40"
            Margin="20,10"
            Background="{DynamicResource DangerBrush}">
            <TextBlock
              HorizontalAlignment="Center"
              VerticalAlignment="Center"
              FontSize="20"
              Text="💎" />
          </hc:SimplePanel>
          <TextBlock
            Margin="10,0"
            VerticalAlignment="Center"
            FontSize="24"
            FontWeight="Bold"
            Foreground="White"
            Text="RugPlay" />
        </StackPanel>

        <!--  User Stats  -->
        <StackPanel
          Grid.Column="2"
          Margin="20,10"
          VerticalAlignment="Center"
          Orientation="Horizontal">
          <hc:Card Style="{StaticResource StatCardStyle}">
            <StackPanel>
              <TextBlock
                FontSize="12"
                Foreground="{DynamicResource SecondaryTextBrush}"
                Text="Balance" />
              <TextBlock
                FontSize="16"
                FontWeight="Bold"
                Foreground="{DynamicResource SuccessBrush}"
                Text="{Binding Balance, StringFormat='${0:N0} BUSS'}" />
            </StackPanel>
          </hc:Card>

          <hc:Card Style="{StaticResource StatCardStyle}">
            <StackPanel>
              <TextBlock
                FontSize="12"
                Foreground="{DynamicResource SecondaryTextBrush}"
                Text="Profit/Loss" />
              <TextBlock
                FontSize="16"
                FontWeight="Bold"
                Foreground="{DynamicResource SuccessBrush}"
                Text="{Binding ProfitLoss, StringFormat='+${0:N0}'}" />
            </StackPanel>
          </hc:Card>

          <hc:Card Style="{StaticResource StatCardStyle}">
            <StackPanel>
              <TextBlock
                FontSize="12"
                Foreground="{DynamicResource SecondaryTextBrush}"
                Text="Rank" />
              <TextBlock
                FontSize="16"
                FontWeight="Bold"
                Foreground="{DynamicResource WarningBrush}"
                Text="{Binding Rank, StringFormat='#{0}'}" />
            </StackPanel>
          </hc:Card>
        </StackPanel>
      </Grid>
    </hc:Card>

    <!--  Main Content  -->
    <Grid Grid.Row="1" Margin="20">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="1*" />
        <ColumnDefinition Width="1*" />
        <ColumnDefinition Width="1*" />
      </Grid.ColumnDefinitions>

      <!--  Coinflip Game  -->
      <hc:Card Grid.Column="0" Style="{StaticResource GambleCardStyle}">
        <StackPanel>
          <Grid Margin="0,0,0,20">
            <TextBlock
              HorizontalAlignment="Left"
              FontSize="24"
              FontWeight="Bold"
              Text="🪙 Coinflip" />
            <hc:Tag
              HorizontalAlignment="Right"
              Background="{DynamicResource DangerBrush}"
              Content="HOT" />
          </Grid>

          <!--  Coin Animation Area  -->
          <hc:SimplePanel
            Height="200"
            Margin="0,0,0,20"
            Background="{DynamicResource SecondaryRegionBrush}">
            <Ellipse
              Width="120"
              Height="120"
              HorizontalAlignment="Center"
              VerticalAlignment="Center"
              Fill="{DynamicResource WarningBrush}"
              Stroke="{DynamicResource BorderBrush}"
              StrokeThickness="3">
              <Ellipse.Effect>
                <DropShadowEffect
                  BlurRadius="20"
                  Opacity="0.6"
                  ShadowDepth="0"
                  Color="Gold" />
              </Ellipse.Effect>
            </Ellipse>
            <TextBlock
              HorizontalAlignment="Center"
              VerticalAlignment="Center"
              FontSize="60"
              Text="💰" />
          </hc:SimplePanel>

          <!--  Bet Amount  -->
          <StackPanel Margin="0,0,0,15">
            <TextBlock
              Margin="0,0,0,5"
              FontWeight="Bold"
              Text="Bet Amount" />
            <hc:NumericUpDown
              Maximum="5000"
              Minimum="10"
              Style="{StaticResource NumericUpDownExtend}"
              Value="{Binding CoinflipBetAmount}" />
          </StackPanel>

          <!--  Side Selection  -->
          <StackPanel Margin="0,0,0,20">
            <TextBlock
              Margin="0,0,0,5"
              FontWeight="Bold"
              Text="Choose Side" />
            <hc:UniformSpacingPanel Orientation="Horizontal" Spacing="10">
              <Button
                Width="100"
                Height="40"
                Background="{Binding SelectedCoinflipSide, Converter={x:Static local:Converters.CoinflipSideToColorConverter}, ConverterParameter=HEADS}"
                Command="{Binding SelectCoinflipSideCommand}"
                CommandParameter="HEADS"
                Content="HEADS"
                FontWeight="Bold"
                Foreground="White" />
              <Button
                Width="100"
                Height="40"
                Background="{Binding SelectedCoinflipSide, Converter={x:Static local:Converters.CoinflipSideToColorConverter}, ConverterParameter=TAILS}"
                Command="{Binding SelectCoinflipSideCommand}"
                CommandParameter="TAILS"
                Content="TAILS"
                FontWeight="Bold"
                Foreground="White" />
            </hc:UniformSpacingPanel>
          </StackPanel>

          <!--  Flip Button  -->
          <Button
            Height="50"
            Background="{DynamicResource PrimaryBrush}"
            Command="{Binding FlipCoinCommand}"
            Content="{Binding IsFlipping, Converter={x:Static local:Converters.FlipButtonTextConverter}}"
            FontSize="16"
            FontWeight="Bold"
            Foreground="White"
            IsEnabled="{Binding IsFlipping, Converter={x:Static local:Converters.InverseBooleanConverter}}"
            Style="{StaticResource ButtonPrimary}" />

          <!--  Recent Results  -->
          <hc:Divider Margin="0,20" />
          <TextBlock
            Margin="0,0,0,10"
            FontWeight="Bold"
            Text="Recent Results" />
          <ItemsControl ItemsSource="{Binding CoinflipHistory}">
            <ItemsControl.ItemsPanel>
              <ItemsPanelTemplate>
                <StackPanel Orientation="Horizontal" />
              </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
              <DataTemplate>
                <hc:Tag
                  Margin="2"
                  Background="{Binding Converter={x:Static local:Converters.CoinflipResultToColorConverter}}"
                  Content="{Binding}" />
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>
        </StackPanel>
      </hc:Card>

      <!--  Slots Game  -->
      <hc:Card Grid.Column="1" Style="{StaticResource GambleCardStyle}">
        <StackPanel>
          <Grid Margin="0,0,0,20">
            <TextBlock
              HorizontalAlignment="Left"
              FontSize="24"
              FontWeight="Bold"
              Text="🎰 Slots" />
            <hc:Tag
              HorizontalAlignment="Right"
              Background="{DynamicResource InfoBrush}"
              Content="NEW" />
          </Grid>

          <!--  Slot Machine  -->
          <hc:SimplePanel
            Height="200"
            Margin="0,0,0,20"
            Background="{DynamicResource SecondaryRegionBrush}">
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
              </Grid.ColumnDefinitions>

              <!--  Slot Reels  -->
              <Border
                Grid.Column="0"
                Margin="5"
                Background="{DynamicResource RegionBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="2"
                CornerRadius="10">
                <TextBlock
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  FontSize="40"
                  Text="{Binding SlotReels[0]}" />
              </Border>

              <Border
                Grid.Column="1"
                Margin="5"
                Background="{DynamicResource RegionBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="2"
                CornerRadius="10">
                <TextBlock
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  FontSize="40"
                  Text="{Binding SlotReels[1]}" />
              </Border>

              <Border
                Grid.Column="2"
                Margin="5"
                Background="{DynamicResource RegionBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="2"
                CornerRadius="10">
                <TextBlock
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  FontSize="40"
                  Text="{Binding SlotReels[2]}" />
              </Border>
            </Grid>
          </hc:SimplePanel>

          <!--  Bet Amount  -->
          <StackPanel Margin="0,0,0,15">
            <TextBlock
              Margin="0,0,0,5"
              FontWeight="Bold"
              Text="Bet Amount" />
            <hc:NumericUpDown
              Maximum="2500"
              Minimum="5"
              Style="{StaticResource NumericUpDownExtend}"
              Value="{Binding SlotsBetAmount}" />
          </StackPanel>

          <!--  Spin Button  -->
          <Button
            Height="50"
            Background="{DynamicResource DangerBrush}"
            Command="{Binding SpinSlotsCommand}"
            Content="{Binding IsSpinning, Converter={x:Static local:Converters.SpinButtonTextConverter}}"
            FontSize="16"
            FontWeight="Bold"
            Foreground="White"
            IsEnabled="{Binding IsSpinning, Converter={x:Static local:Converters.InverseBooleanConverter}}"
            Style="{StaticResource ButtonDanger}" />

          <!--  Paytable  -->
          <hc:Divider Margin="0,20" />
          <TextBlock
            Margin="0,0,0,10"
            FontWeight="Bold"
            Text="Paytable" />
          <StackPanel>
            <Grid Margin="0,2">
              <TextBlock HorizontalAlignment="Left" Text="🍒🍒🍒" />
              <TextBlock
                HorizontalAlignment="Right"
                Foreground="{DynamicResource SuccessBrush}"
                Text="50x" />
            </Grid>
            <Grid Margin="0,2">
              <TextBlock HorizontalAlignment="Left" Text="🍋🍋🍋" />
              <TextBlock
                HorizontalAlignment="Right"
                Foreground="{DynamicResource SuccessBrush}"
                Text="25x" />
            </Grid>
            <Grid Margin="0,2">
              <TextBlock HorizontalAlignment="Left" Text="⭐⭐⭐" />
              <TextBlock
                HorizontalAlignment="Right"
                Foreground="{DynamicResource WarningBrush}"
                Text="100x" />
            </Grid>
          </StackPanel>
        </StackPanel>
      </hc:Card>

      <!--  Stats & Activity  -->
      <hc:Card Grid.Column="2" Style="{StaticResource GambleCardStyle}">
        <StackPanel>
          <TextBlock
            Margin="0,0,0,20"
            FontSize="24"
            FontWeight="Bold"
            Text="📊 Gaming Stats" />

          <!--  Quick Stats  -->
          <hc:SimpleStackPanel Margin="0,0,0,20">
            <hc:Card Padding="15" Background="{DynamicResource SuccessBrush}">
              <StackPanel>
                <TextBlock
                  FontSize="12"
                  Foreground="White"
                  Opacity="0.8"
                  Text="Total Winnings" />
                <TextBlock
                  FontSize="20"
                  FontWeight="Bold"
                  Foreground="White"
                  Text="{Binding TotalWinnings, StringFormat='${0:N0}'}" />
              </StackPanel>
            </hc:Card>

            <hc:Card Padding="15" Background="{DynamicResource DangerBrush}">
              <StackPanel>
                <TextBlock
                  FontSize="12"
                  Foreground="White"
                  Opacity="0.8"
                  Text="Total Losses" />
                <TextBlock
                  FontSize="20"
                  FontWeight="Bold"
                  Foreground="White"
                  Text="{Binding TotalLosses, StringFormat='${0:N0}'}" />
              </StackPanel>
            </hc:Card>

            <hc:Card Padding="15" Background="{DynamicResource InfoBrush}">
              <StackPanel>
                <TextBlock
                  FontSize="12"
                  Foreground="White"
                  Opacity="0.8"
                  Text="Games Played" />
                <TextBlock
                  FontSize="20"
                  FontWeight="Bold"
                  Foreground="White"
                  Text="{Binding GamesPlayed}" />
              </StackPanel>
            </hc:Card>
          </hc:SimpleStackPanel>

          <!--  Recent Activity  -->
          <hc:Divider Margin="0,10" />
          <TextBlock
            Margin="0,10,0,15"
            FontWeight="Bold"
            Text="Recent Activity" />

          <ScrollViewer Height="200" VerticalScrollBarVisibility="Auto">
            <ItemsControl ItemsSource="{Binding RecentActivities}">
              <ItemsControl.ItemTemplate>
                <DataTemplate>
                  <Border
                    Margin="0,0,0,5"
                    Padding="10"
                    Background="{DynamicResource SecondaryRegionBrush}"
                    CornerRadius="5">
                    <Grid>
                      <StackPanel HorizontalAlignment="Left">
                        <TextBlock FontSize="12" Text="{Binding Game}" />
                        <TextBlock
                          FontSize="10"
                          Foreground="{DynamicResource SecondaryTextBrush}"
                          Text="{Binding TimeAgo}" />
                      </StackPanel>
                      <TextBlock
                        HorizontalAlignment="Right"
                        FontWeight="Bold"
                        Foreground="{Binding IsWin, Converter={x:Static local:Converters.WinLossToColorConverter}}"
                        Text="{Binding Amount, Converter={x:Static local:Converters.AmountToStringConverter}}" />
                    </Grid>
                  </Border>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>
          </ScrollViewer>

          <!--  Quick Actions  -->
          <hc:Divider Margin="0,15" />
          <hc:UniformSpacingPanel Orientation="Horizontal" Spacing="10">
            <Button
              Width="100"
              Command="{Binding ShowLeaderboardCommand}"
              Content="Leaderboard"
              Style="{StaticResource ButtonDefault}" />
            <Button
              Width="100"
              Command="{Binding ShowHistoryCommand}"
              Content="History"
              Style="{StaticResource ButtonDefault}" />
          </hc:UniformSpacingPanel>
        </StackPanel>
      </hc:Card>
    </Grid>
  </Grid>
</hc:Window>
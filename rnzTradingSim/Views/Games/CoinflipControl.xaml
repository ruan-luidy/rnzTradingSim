<UserControl
  x:Class="rnzTradingSim.Views.Games.CoinflipControl"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:hc="https://handyorg.github.io/handycontrol"
  xmlns:local="clr-namespace:rnzTradingSim"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  d:DesignHeight="450"
  d:DesignWidth="850"
  mc:Ignorable="d">

  <Grid>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="1*" />
      <ColumnDefinition Width="1*" />
    </Grid.ColumnDefinitions>

    <!--  Left Side - Coin and Session  -->
    <StackPanel Grid.Column="0" VerticalAlignment="Center">
      <!--  Session Balance  -->
      <StackPanel Margin="0,0,0,30" HorizontalAlignment="Center">
        <TextBlock
          HorizontalAlignment="Center"
          FontSize="14"
          Text="Session P&amp;L" />
        <TextBlock
          HorizontalAlignment="Center"
          FontSize="24"
          FontWeight="Bold"
          Text="{Binding SessionBalance, StringFormat='{}{0:+$#,0.00;-$#,0.00;$0.00}'}" />
      </StackPanel>

      <!--  Coin Display  -->
      <Border
        Width="150"
        Height="150"
        HorizontalAlignment="Center"
        Background="{DynamicResource RegionBrush}"
        BorderBrush="{DynamicResource BorderBrush}"
        BorderThickness="2"
        CornerRadius="10">

        <Grid>
          <!--  Coin Animation  -->
          <Ellipse
            x:Name="CoinEllipse"
            Width="100"
            Height="100"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Fill="Gold"
            RenderTransformOrigin="0.5,0.5"
            Stroke="DarkGoldenrod"
            StrokeThickness="3">
            <Ellipse.RenderTransform>
              <ScaleTransform x:Name="CoinScale" ScaleX="1" />
            </Ellipse.RenderTransform>
          </Ellipse>

          <!--  Coin Text  -->
          <TextBlock
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            FontSize="24"
            FontWeight="Bold"
            Text="{Binding FinalResult}" />

          <!--  Loading when flipping  -->
          <hc:LoadingCircle
            Width="120"
            Height="120"
            IsRunning="{Binding IsFlipping}"
            Opacity="0.3"
            Visibility="{Binding IsFlipping, Converter={StaticResource Boolean2VisibilityConverter}}" />
        </Grid>
      </Border>
    </StackPanel>

    <!--  Right Side - Controls  -->
    <StackPanel
      Grid.Column="1"
      Margin="30,0,0,0"
      VerticalAlignment="Center">

      <!--  Choose Side  -->
      <StackPanel Margin="0,0,0,30">
        <TextBlock
          Margin="0,0,0,10"
          FontSize="16"
          FontWeight="Bold"
          Text="Choose Side" />

        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
          </Grid.ColumnDefinitions>

          <Button
            Grid.Column="0"
            Height="50"
            Margin="0,0,5,0"
            Command="{Binding SelectSideCommand}"
            CommandParameter="HEADS"
            Content="HEADS"
            FontWeight="Bold" />

          <Button
            Grid.Column="1"
            Height="50"
            Margin="5,0,0,0"
            Command="{Binding SelectSideCommand}"
            CommandParameter="TAILS"
            Content="TAILS"
            FontWeight="Bold" />
        </Grid>
      </StackPanel>

      <!--  Bet Amount  -->
      <StackPanel Margin="0,0,0,30">
        <TextBlock
          Margin="0,0,0,10"
          FontSize="16"
          FontWeight="Bold"
          Text="Bet Amount" />

        <hc:NumericUpDown
          Height="40"
          Maximum="10000"
          Minimum="1"
          Value="{Binding BetAmount}" />

        <TextBlock
          Margin="0,5,0,0"
          FontSize="12"
          Text="{Binding ParentBalance, StringFormat='Max bet: ${0:N0}'}" />

        <!--  Quick Bet Buttons  -->
        <Grid Margin="0,10,0,0">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
          </Grid.ColumnDefinitions>

          <Button
            Grid.Column="0"
            Height="30"
            Margin="0,0,2,0"
            Command="{Binding SetBetPercentageCommand}"
            CommandParameter="0.25"
            Content="25%" />
          <Button
            Grid.Column="1"
            Height="30"
            Margin="2,0,2,0"
            Command="{Binding SetBetPercentageCommand}"
            CommandParameter="0.50"
            Content="50%" />
          <Button
            Grid.Column="2"
            Height="30"
            Margin="2,0,2,0"
            Command="{Binding SetBetPercentageCommand}"
            CommandParameter="0.75"
            Content="75%" />
          <Button
            Grid.Column="3"
            Height="30"
            Margin="2,0,0,0"
            Command="{Binding SetBetPercentageCommand}"
            CommandParameter="1.0"
            Content="Max" />
        </Grid>
      </StackPanel>

      <!--  Flip Button  -->
      <Button
        Height="50"
        Command="{Binding FlipCommand}"
        Content="{Binding IsFlipping, Converter={x:Static local:Converters.FlipButtonTextConverter}}"
        FontSize="16"
        FontWeight="Bold"
        IsEnabled="{Binding IsFlipping, Converter={x:Static local:Converters.InverseBooleanConverter}}" />
    </StackPanel>
  </Grid>
</UserControl>